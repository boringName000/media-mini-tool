# 文件下载测试页面

## 功能说明

这是一个用于测试文件下载和预览功能的页面，主要包含以下功能：

### 1. 文件下载功能

- 从云存储下载测试文件
- 自动保存到本地文件系统
- 支持文件格式检测和错误处理

### 2. 文件管理功能

- 查看已下载的文件列表
- 显示文件大小、修改时间等详细信息
- 支持文件排序和筛选

### 3. 文件预览功能

- 读取本地文件内容
- 支持多种编码格式（UTF-8、Base64 等）
- **新增：HTML 内容渲染预览**
  - 在文件内容预览框添加"查看效果"按钮
  - 使用 rich-text 组件解析和渲染 HTML 内容
  - 支持基本的 HTML 标签和样式
  - 可在源码视图和渲染效果视图之间切换

### 4. rich-text 渲染支持

使用 rich-text 组件提供基本的 HTML 渲染支持：

- **基本 HTML 标签支持**: 标题、段落、文本格式、列表、代码等
- **内联样式支持**: 支持基本的 CSS 样式
- **小程序原生渲染**: 使用小程序内置组件进行渲染
- **美观的界面**: 现代化的预览界面设计
- **错误处理**: 完善的错误处理和用户提示

## 使用方法

1. **下载文件**：点击"下载测试文件"按钮开始下载
2. **查看文件列表**：点击"查看下载文件列表"查看已下载的文件
3. **预览文件内容**：点击文件列表中的任意文件进行预览
4. **查看渲染效果**：在文件预览界面点击"查看效果"按钮查看 HTML 渲染效果
5. **切换视图**：在渲染效果界面点击"查看源码"按钮返回原始文本视图

## 技术实现

### 文件系统操作

- 使用微信小程序的文件系统管理器
- 支持本地文件读写和目录管理
- 自动处理文件编码和格式转换

### rich-text 渲染引擎

- 使用正则表达式解析 HTML 内容
- 将 HTML 转换为 rich-text 支持的格式
- 在小程序页面内直接渲染 HTML 内容
- 支持基本的 HTML 标签和样式

### 错误处理

- 完善的异常捕获和错误提示
- 多种编码格式的自动尝试
- 用户友好的错误信息展示

## 注意事项

1. 文件下载需要网络连接
2. 本地存储空间有限，建议定期清理
3. rich-text 渲染功能主要支持基本标签，复杂布局可能显示异常
4. 支持基本的 HTML 和样式功能，渲染效果简洁美观
5. 如果解析失败，系统会提供复制到剪贴板的备选方案
