<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="æ–‡ç« é¢„è§ˆåˆ›ä½œè€…å·¥å…·" />
    <title>æ–‡ç« é¢„è§ˆ-åˆ›ä½œè€…å·¥å…·</title>

    <!-- å¼•å…¥vConsoleç”¨äºç§»åŠ¨ç«¯è°ƒè¯• -->
    <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>

    <style>
      /* åŸºç¡€æ ·å¼ */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        line-height: 1.6;
        color: #1f2937;
        background-color: #f8f9fa;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* å¤´éƒ¨æ ·å¼ */
      .header {
        background-color: #fff;
        border-bottom: 1px solid #e0e0e0;
        padding: 1rem 0;
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header .container {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 1rem 20px;
      }

      .logo {
        font-size: 1.8rem;
        font-weight: 700;
        color: #333;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      /* ä¸»è¦å†…å®¹åŒºåŸŸ */
      .main {
        min-height: calc(100vh - 140px);
        padding: 2rem 0;
      }

      /* è½¬æ¢é¡µé¢æ ·å¼ */
      .converter-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 0;
        background-color: #f8f9fa;
        min-height: 100vh;
      }

      /* å¤åˆ¶æŒ‰é’®åŒºåŸŸ */
      .copy-button-container {
        padding: 20px 40px; /* å¢åŠ å·¦å³è¾¹è· */
        display: flex;
        gap: 20px;
        justify-content: center;
        background-color: #fff;
        border-bottom: 1px solid #e0e0e0;
      }

      .copy-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 16px 24px;
        font-size: 15px;
        font-weight: 600;
        flex: 0 0 auto; /* å›ºå®šå®½åº¦ï¼Œä¸ä¼¸ç¼© */
        width: 180px; /* å›ºå®šå®½åº¦ï¼Œç¡®ä¿æ–‡å­—ä¸æ¢è¡Œ */
        height: 56px; /* å›ºå®šé«˜åº¦ */
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
        white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ¢è¡Œ */
        overflow: hidden; /* éšè—æº¢å‡ºå†…å®¹ */
      }

      .copy-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      }

      .copy-btn:active {
        transform: translateY(0);
      }

      .btn-icon {
        font-size: 18px;
      }

      /* å½“åªæœ‰2ä¸ªæŒ‰é’®æ—¶çš„ç‰¹æ®Šæ ·å¼ */
      .copy-button-container.two-buttons {
        justify-content: center;
        gap: 40px; /* è°ƒæ•´æŒ‰é’®é—´è· */
        padding: 20px 50px; /* 2æŒ‰é’®æ¨¡å¼ä¸‹çš„å·¦å³è¾¹è· */
      }

      .copy-button-container.two-buttons .copy-btn {
        flex: 0 0 auto; /* å›ºå®šå®½åº¦ï¼Œä¸ä¼¸ç¼© */
        width: 180px; /* å›ºå®šå®½åº¦ï¼Œç¡®ä¿æ–‡å­—ä¸æ¢è¡Œ */
      }

      /* é¢„è§ˆå®¹å™¨ */
      .preview-container {
        padding: 30px;
        background-color: #fff;
        margin: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
        min-height: 400px;
      }

      .preview-content {
        width: 100%;
        min-height: 300px;
        padding: 20px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        background-color: #fff;
        overflow: auto;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
          "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue",
          Helvetica, Arial, sans-serif;
        line-height: 1.6;
      }

      .preview-placeholder {
        text-align: center;
        color: #6c757d;
        padding: 40px 20px;
      }

      .placeholder-icon {
        font-size: 3rem;
        margin-bottom: 15px;
        opacity: 0.6;
      }

      .preview-placeholder p {
        margin: 0;
        font-size: 16px;
      }

      /* å“åº”å¼è®¾è®¡ */
      @media (max-width: 768px) {
        .copy-button-container {
          padding: 15px 25px; /* ç§»åŠ¨ç«¯ä¿æŒåˆé€‚çš„å·¦å³è¾¹è· */
          gap: 15px;
        }

        .copy-btn {
          max-width: 150px;
          padding: 14px 24px;
          font-size: 14px;
        }

        /* ç§»åŠ¨ç«¯2æŒ‰é’®æ¨¡å¼ç‰¹æ®Šæ ·å¼ */
        .copy-button-container.two-buttons {
          padding: 15px 25px; /* ç§»åŠ¨ç«¯2æŒ‰é’®æ¨¡å¼ä¸‹çš„è¾¹è· */
          gap: 15px; /* ç§»åŠ¨ç«¯æŒ‰é’®é—´è· */
        }

        .copy-button-container.two-buttons .copy-btn {
          width: 150px; /* ç§»åŠ¨ç«¯æŒ‰é’®å®½åº¦ï¼Œç¡®ä¿æ–‡å­—ä¸æ¢è¡Œ */
        }

        .preview-container {
          margin: 10px;
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <!-- é¡µé¢å¤´éƒ¨ -->
    <header class="header">
      <div class="container">
        <h1 class="logo">æ–‡ç« é¢„è§ˆ-åˆ›ä½œè€…å·¥å…·</h1>
      </div>
    </header>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="main">
      <div class="converter-container">
        <!-- å¤åˆ¶æŒ‰é’®åŒºåŸŸ -->
        <div class="copy-button-container">
          <button class="copy-btn copy-title-btn" id="copyTitleBtn">
            <span class="btn-icon">ğŸ“‹</span>
            å¤åˆ¶æ–‡ç« æ ‡é¢˜
          </button>
          <button class="copy-btn copy-content-btn" id="copyContentBtn">
            <span class="btn-icon">ğŸ“‹</span>
            å¤åˆ¶é¢„è§ˆæ•ˆæœ
          </button>
        </div>

        <!-- HTMLé¢„è§ˆåŒºåŸŸ -->
        <div class="preview-container">
          <div class="preview-content" id="previewContent">
            <div class="preview-placeholder">
              <div class="placeholder-icon">ğŸ‘ï¸</div>
              <p>ç­‰å¾…æ¥æ”¶å°ç¨‹åºå‘é€çš„HTMLå†…å®¹...</p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script>
      // ===== å…¨å±€é…ç½®å¼€å…³ =====
      const CONFIG = {
        // æ˜¯å¦å¯ç”¨vConsoleè°ƒè¯•é¢æ¿ (å‘å¸ƒæ—¶è®¾ç½®ä¸ºfalse)
        // å¯ç”¨æ—¶è‡ªåŠ¨å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼Œå…³é—­æ—¶è‡ªåŠ¨å…³é—­è¯¦ç»†æ—¥å¿—
        ENABLE_VCONSOLE: true,
      };

      // ğŸ’¡ é…ç½®è¯´æ˜ï¼š
      // - å¼€å‘ç¯å¢ƒï¼šè®¾ç½® ENABLE_VCONSOLE: trueï¼Œè‡ªåŠ¨å¯ç”¨è¯¦ç»†æ—¥å¿—å’ŒvConsole
      // - ç”Ÿäº§ç¯å¢ƒï¼šè®¾ç½® ENABLE_VCONSOLE: falseï¼Œè‡ªåŠ¨å…³é—­æ‰€æœ‰è°ƒè¯•åŠŸèƒ½
      // - æ‰€æœ‰è°ƒè¯•ä¿¡æ¯é€šè¿‡vConsoleæŸ¥çœ‹ï¼Œé¡µé¢ä¿æŒç®€æ´

      // å…¨å±€å˜é‡å­˜å‚¨ä»å°ç¨‹åºæ¥æ”¶çš„æ•°æ®
      let receivedData = {
        title: "",
        content: "",
        fileName: "",
        fileSize: "",
        timestamp: null,
      };

      // åˆå§‹åŒ–é¡µé¢
      function initPage() {
        console.log("æ–‡ç« é¢„è§ˆåˆ›ä½œè€…å·¥å…·é¡µé¢å·²åŠ è½½");
        initEventListeners();
        initWechatCommunication();
      }

      // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
      function initEventListeners() {
        // å¤åˆ¶æ ‡é¢˜æŒ‰é’®
        const copyTitleBtn = document.getElementById("copyTitleBtn");
        if (copyTitleBtn) {
          copyTitleBtn.addEventListener("click", copyTitle);
        }

        // å¤åˆ¶å†…å®¹æŒ‰é’®
        const copyContentBtn = document.getElementById("copyContentBtn");
        if (copyContentBtn) {
          copyContentBtn.addEventListener("click", copyContent);
        }

        // ç”±äºåˆ é™¤äº†è°ƒè¯•æŒ‰é’®ï¼Œç°åœ¨æ€»æ˜¯åªæœ‰2ä¸ªæŒ‰é’®ï¼Œåº”ç”¨2æŒ‰é’®æ ·å¼
        const buttonContainer = document.querySelector(
          ".copy-button-container"
        );
        if (buttonContainer) {
          buttonContainer.classList.add("two-buttons");
        }
      }

      // å¤åˆ¶æ ‡é¢˜åŠŸèƒ½
      function copyTitle() {
        // ä»URLå‚æ•°ä¸­è·å–æ–‡ä»¶åä½œä¸ºæ ‡é¢˜
        const urlParams = new URLSearchParams(window.location.search);
        const fileName = urlParams.get("fileName");

        if (fileName) {
          const title = decodeURIComponent(fileName);
          copyToClipboard(title);
          showToast("æ–‡ç« æ ‡é¢˜å·²å¤åˆ¶åˆ°å‰ªè´´æ¿", "success");
          if (CONFIG.ENABLE_VCONSOLE) {
            console.log("âœ… å¤åˆ¶æ ‡é¢˜æˆåŠŸ:", title);
          }
        } else {
          showToast("æš‚æ— æ–‡ç« æ ‡é¢˜å¯å¤åˆ¶", "warning");
        }
      }

      // å¤åˆ¶é¢„è§ˆæ•ˆæœåŠŸèƒ½
      function copyContent() {
        // è·å–é¢„è§ˆæ¡†å®¹å™¨
        const previewContent = document.getElementById("previewContent");

        if (!previewContent) {
          showToast("é¢„è§ˆå†…å®¹ä¸å­˜åœ¨", "error");
          return;
        }

        try {
          // ç›´æ¥å¤åˆ¶é¢„è§ˆæ¡†å†…çš„HTMLå†…å®¹ï¼ˆåŒ…å«æ‰€æœ‰æ ¼å¼å’Œæ ·å¼ï¼‰
          const htmlContent = previewContent.innerHTML;

          if (!htmlContent || htmlContent.trim() === "") {
            showToast("é¢„è§ˆå†…å®¹ä¸ºç©ºï¼Œæ— æ³•å¤åˆ¶", "warning");
            return;
          }

          // ä½¿ç”¨ç°ä»£Clipboard APIå¤åˆ¶HTMLæ ¼å¼
          if (navigator.clipboard && window.ClipboardItem) {
            const clipboardItem = new ClipboardItem({
              "text/html": new Blob([htmlContent], { type: "text/html" }),
              "text/plain": new Blob([previewContent.textContent || ""], {
                type: "text/plain",
              }),
            });

            navigator.clipboard
              .write([clipboardItem])
              .then(() => {
                showToast("é¢„è§ˆæ•ˆæœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿", "success");
                if (CONFIG.ENABLE_VCONSOLE) {
                  console.log("âœ… å¤åˆ¶é¢„è§ˆæ•ˆæœæˆåŠŸ");
                }
              })
              .catch(() => {
                // é™çº§æ–¹æ¡ˆ
                copyWithExecCommand(htmlContent);
              });
          } else {
            // é™çº§æ–¹æ¡ˆ
            copyWithExecCommand(htmlContent);
          }
        } catch (error) {
          console.error("å¤åˆ¶é¢„è§ˆæ•ˆæœå¤±è´¥:", error);
          showToast("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å†…å®¹", "error");
        }
      }

      // é™çº§å¤åˆ¶æ–¹æ¡ˆ
      function copyWithExecCommand(htmlContent) {
        try {
          // åˆ›å»ºä¸´æ—¶å®¹å™¨å¹¶å¤åˆ¶å†…å®¹
          const tempDiv = document.createElement("div");
          tempDiv.style.position = "absolute";
          tempDiv.style.left = "-9999px";
          tempDiv.innerHTML = htmlContent;
          document.body.appendChild(tempDiv);

          // é€‰æ‹©å¹¶å¤åˆ¶
          const range = document.createRange();
          range.selectNodeContents(tempDiv);
          const selection = window.getSelection();
          selection.removeAllRanges();
          selection.addRange(range);

          const success = document.execCommand("copy");
          selection.removeAllRanges();
          document.body.removeChild(tempDiv);

          if (success) {
            showToast("é¢„è§ˆæ•ˆæœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿", "success");
            if (CONFIG.ENABLE_VCONSOLE) {
              console.log("âœ… é™çº§æ–¹æ¡ˆå¤åˆ¶æˆåŠŸ");
            }
          } else {
            showToast("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å†…å®¹", "error");
          }
        } catch (error) {
          console.error("é™çº§å¤åˆ¶å¤±è´¥:", error);
          showToast("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å†…å®¹", "error");
        }
      }

      // å¤åˆ¶åˆ°å‰ªè´´æ¿
      async function copyToClipboard(text) {
        try {
          await navigator.clipboard.writeText(text);
          return true;
        } catch (err) {
          // é™çº§æ–¹æ¡ˆ
          const textArea = document.createElement("textarea");
          textArea.value = text;
          document.body.appendChild(textArea);
          textArea.select();
          try {
            document.execCommand("copy");
            document.body.removeChild(textArea);
            return true;
          } catch (err) {
            document.body.removeChild(textArea);
            return false;
          }
        }
      }

      // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
      function showToast(message, type = "info") {
        // åˆ›å»ºtoastå…ƒç´ 
        const toast = document.createElement("div");
        toast.className = `toast toast-${type}`;
        toast.textContent = message;

        // æ·»åŠ æ ·å¼
        Object.assign(toast.style, {
          position: "fixed",
          top: "20px",
          right: "20px",
          padding: "12px 20px",
          borderRadius: "6px",
          color: "white",
          fontSize: "14px",
          fontWeight: "500",
          zIndex: "10000",
          opacity: "0",
          transform: "translateX(100%)",
          transition: "all 0.3s ease",
        });

        // æ ¹æ®ç±»å‹è®¾ç½®èƒŒæ™¯è‰²
        const colors = {
          success: "#28a745",
          error: "#dc3545",
          warning: "#ffc107",
          info: "#17a2b8",
        };

        toast.style.backgroundColor = colors[type] || colors.info;

        // æ·»åŠ åˆ°é¡µé¢
        document.body.appendChild(toast);

        // æ˜¾ç¤ºåŠ¨ç”»
        setTimeout(() => {
          toast.style.opacity = "1";
          toast.style.transform = "translateX(0)";
        }, 100);

        // è‡ªåŠ¨éšè—
        setTimeout(() => {
          toast.style.opacity = "0";
          toast.style.transform = "translateX(100%)";
          setTimeout(() => {
            if (document.body.contains(toast)) {
              document.body.removeChild(toast);
            }
          }, 300);
        }, 3000);
      }

      // åˆå§‹åŒ–é¡µé¢
      function initWechatCommunication() {
        // æ£€æŸ¥URLå‚æ•°ä¸­æ˜¯å¦æœ‰ä¸´æ—¶ä¸‹è½½URL
        checkURLParameters();
      }

      // æ£€æŸ¥URLå‚æ•°
      function checkURLParameters() {
        if (CONFIG.ENABLE_VCONSOLE) {
          console.log("=== å¼€å§‹æ£€æŸ¥URLå‚æ•° ===");
          console.log("å½“å‰é¡µé¢URL:", window.location.href);
          console.log("URLæŸ¥è¯¢å­—ç¬¦ä¸²:", window.location.search);
        }

        const urlParams = new URLSearchParams(window.location.search);
        if (CONFIG.ENABLE_VCONSOLE) {
          console.log("æ‰€æœ‰URLå‚æ•°:", Object.fromEntries(urlParams.entries()));
        }

        const tempUrl = urlParams.get("tempUrl");
        const fileName = urlParams.get("fileName");

        if (tempUrl) {
          if (CONFIG.ENABLE_VCONSOLE) {
            console.log("âœ… ä»URLå‚æ•°è·å–åˆ°ä¸´æ—¶ä¸‹è½½URL:", tempUrl);
            console.log("ğŸ“ æ–‡ä»¶å:", fileName);
          }

          // ä¸‹è½½æ–‡ä»¶å†…å®¹
          downloadAndDisplayFile(tempUrl, fileName);
        } else {
          if (CONFIG.ENABLE_VCONSOLE) {
            console.log("â„¹ï¸ æœªæ‰¾åˆ°URLå‚æ•°ï¼Œç­‰å¾…å…¶ä»–æ–¹å¼è·å–å†…å®¹");
          }

          // æ˜¾ç¤ºç­‰å¾…çŠ¶æ€
          const previewContent = document.getElementById("previewContent");
          if (previewContent) {
            previewContent.innerHTML = `
              <div class="preview-placeholder">
                <div class="placeholder-icon">â³</div>
                <p>ç­‰å¾…è·å–æ–‡ä»¶å†…å®¹...</p>
                <p style="font-size: 14px; color: #666; margin-top: 10px;">è¯·é€šè¿‡vConsoleæŸ¥çœ‹è¯¦ç»†è°ƒè¯•ä¿¡æ¯</p>
              </div>
            `;
          }
        }
      }

      // ä¸‹è½½å¹¶æ˜¾ç¤ºæ–‡ä»¶å†…å®¹
      async function downloadAndDisplayFile(tempUrl, fileName) {
        try {
          if (CONFIG.ENABLE_VCONSOLE) {
            console.log("ğŸ”„ å¼€å§‹ä¸‹è½½æ–‡ä»¶...");
            console.log("ğŸ“¥ ä¸‹è½½URL:", tempUrl);
            console.log("ğŸ“ æ–‡ä»¶å:", fileName);
            console.log("â° å¼€å§‹æ—¶é—´:", new Date().toLocaleString());
          }

          // ä¸‹è½½çŠ¶æ€ä¿¡æ¯é€šè¿‡vConsoleæŸ¥çœ‹
          showToast("æ­£åœ¨ä¸‹è½½æ–‡ä»¶å†…å®¹...", "info");

          const startTime = Date.now();
          const response = await fetch(tempUrl);
          const endTime = Date.now();

          if (CONFIG.ENABLE_VCONSOLE) {
            console.log(
              "ğŸ“¡ HTTPå“åº”çŠ¶æ€:",
              response.status,
              response.statusText
            );
            console.log("â±ï¸ ä¸‹è½½è€—æ—¶:", endTime - startTime, "ms");
          }

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          if (CONFIG.ENABLE_VCONSOLE) {
            console.log("ğŸ“– å¼€å§‹è¯»å–å“åº”å†…å®¹...");
          }
          const content = await response.text();

          if (CONFIG.ENABLE_VCONSOLE) {
            console.log("âœ… æ–‡ä»¶ä¸‹è½½æˆåŠŸï¼");
            console.log("ğŸ“Š å†…å®¹é•¿åº¦:", content.length, "å­—ç¬¦");
            console.log(
              "ğŸ“Š å†…å®¹å¤§å°:",
              ((content.length * 2) / 1024).toFixed(2),
              "KB"
            );
            console.log("â° å®Œæˆæ—¶é—´:", new Date().toLocaleString());
          }

          // ä¸‹è½½æˆåŠŸçŠ¶æ€é€šè¿‡vConsoleæŸ¥çœ‹

          // è®¾ç½®HTMLå†…å®¹
          const messageData = {
            type: "SET_HTML_CONTENT",
            content: content,
            fileName: fileName || "ä¸‹è½½çš„æ–‡ä»¶",
            fileSize: content.length,
            timestamp: Date.now(),
          };

          setHTMLContent(messageData);
          showToast("æ–‡ä»¶å†…å®¹å·²åŠ è½½å®Œæˆ", "success");
        } catch (error) {
          if (CONFIG.ENABLE_VCONSOLE) {
            console.error("âŒ æ–‡ä»¶ä¸‹è½½å¤±è´¥:", error);
            console.error("âŒ é”™è¯¯è¯¦æƒ…:", error.stack);
          }
          showToast("æ–‡ä»¶ä¸‹è½½å¤±è´¥: " + error.message, "error");

          // ä¸‹è½½å¤±è´¥çŠ¶æ€é€šè¿‡vConsoleæŸ¥çœ‹

          // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
          const previewContent = document.getElementById("previewContent");
          if (previewContent) {
            previewContent.innerHTML = `
              <div class="preview-placeholder">
                <div class="placeholder-icon">âš ï¸</div>
                <p>æ–‡ä»¶ä¸‹è½½å¤±è´¥</p>
                <p style="font-size: 14px; color: #666; margin-top: 10px;">${error.message}</p>
                <p style="font-size: 14px; color: #666; margin-top: 10px;">è¯¦ç»†é”™è¯¯ä¿¡æ¯è¯·æŸ¥çœ‹vConsole</p>
              </div>
            `;
          }
        }
      }

      // è®¾ç½®HTMLå†…å®¹
      function setHTMLContent(data) {
        // ä¿å­˜æ¥æ”¶åˆ°çš„æ•°æ®
        receivedData = {
          title: data.fileName || data.title || "",
          content: data.content || "",
          fileName: data.fileName || "",
          fileSize: data.fileSize || "",
          timestamp: data.timestamp || Date.now(),
        };

        // æ›´æ–°é¢„è§ˆå†…å®¹
        updatePreview(receivedData.content);

        showToast("å·²æ¥æ”¶å°ç¨‹åºå‘é€çš„å†…å®¹", "success");
      }

      // æ›´æ–°é¢„è§ˆ
      function updatePreview(content) {
        const previewContent = document.getElementById("previewContent");

        if (!previewContent) return;

        if (content && content.trim()) {
          try {
            // ç›´æ¥æ¸²æŸ“å†…å®¹ï¼Œä¿æŒç®€å•ç»Ÿä¸€
            previewContent.innerHTML = content;
          } catch (error) {
            console.error("å†…å®¹æ¸²æŸ“é”™è¯¯:", error);
            previewContent.innerHTML = `
              <div class="preview-placeholder">
                <div class="placeholder-icon">âš ï¸</div>
                <p>å†…å®¹æ¸²æŸ“å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ ¼å¼</p>
              </div>
            `;
          }
        } else {
          previewContent.innerHTML = `
            <div class="preview-placeholder">
              <div class="placeholder-icon">ğŸ‘ï¸</div>
              <p>ç­‰å¾…æ¥æ”¶æ–‡ä»¶å†…å®¹...</p>
            </div>
          `;
        }
      }

      // å¯¼å‡ºå‡½æ•°ä¾›å¤–éƒ¨è°ƒç”¨
      window.ConverterPage = {
        setHTMLContent,
        getContent: () => receivedData.content || "",
        getTitle: () => receivedData.title || "",
        getData: () => receivedData,
      };

      // åˆå§‹åŒ–vConsole
      function initVConsole() {
        // æ£€æŸ¥é…ç½®å¼€å…³
        if (!CONFIG.ENABLE_VCONSOLE) {
          console.log("â„¹ï¸ vConsole å·²é€šè¿‡é…ç½®å…³é—­");
          return null;
        }

        try {
          // æ£€æŸ¥æ˜¯å¦åœ¨å¾®ä¿¡å°ç¨‹åºç¯å¢ƒä¸­
          if (typeof window !== "undefined" && window.VConsole) {
            // åˆ›å»ºvConsoleå®ä¾‹
            const vConsole = new window.VConsole({
              theme: "dark", // æ·±è‰²ä¸»é¢˜
              maxLogNumber: 1000, // æœ€å¤§æ—¥å¿—æ•°é‡
              onReady: function () {
                if (CONFIG.ENABLE_VCONSOLE) {
                  console.log("ğŸ‰ vConsole å·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥æŸ¥çœ‹ç§»åŠ¨ç«¯æ—¥å¿—äº†ï¼");
                  console.log("ğŸ“± ç‚¹å‡»å³ä¸‹è§’çš„ vConsole æŒ‰é’®æ‰“å¼€è°ƒè¯•é¢æ¿");
                }
              },
              onClearLog: function () {
                if (CONFIG.ENABLE_VCONSOLE) {
                  console.log("ğŸ§¹ æ—¥å¿—å·²æ¸…ç©º");
                }
              },
            });

            // æ·»åŠ ä¸€äº›æµ‹è¯•æ—¥å¿—
            if (CONFIG.ENABLE_VCONSOLE) {
              console.log("ğŸš€ é¡µé¢åŠ è½½å®Œæˆï¼ŒvConsole å·²åˆå§‹åŒ–");
              console.log("ğŸ“± å½“å‰è®¾å¤‡ä¿¡æ¯:", {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                screenSize: `${screen.width}x${screen.height}`,
                viewportSize: `${window.innerWidth}x${window.innerHeight}`,
              });
            }

            // ä¿å­˜å®ä¾‹åˆ°å…¨å±€å˜é‡
            vConsoleInstance = vConsole;

            return vConsole;
          } else {
            if (CONFIG.ENABLE_VCONSOLE) {
              console.warn("âš ï¸ vConsole æœªåŠ è½½ï¼Œç§»åŠ¨ç«¯è°ƒè¯•åŠŸèƒ½ä¸å¯ç”¨");
            }
            return null;
          }
        } catch (error) {
          if (CONFIG.ENABLE_VCONSOLE) {
            console.error("âŒ åˆå§‹åŒ– vConsole å¤±è´¥:", error);
          }
          return null;
        }
      }

      // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
      document.addEventListener("DOMContentLoaded", function () {
        // åˆå§‹åŒ–vConsole
        initVConsole();

        // åˆå§‹åŒ–é¡µé¢
        initPage();
      });
    </script>
  </body>
</html>
