# 文章预览创作者工具

这是一个专为微信小程序设计的文章预览工具，使用原生 HTML、CSS 和 JavaScript 构建，无需任何外部依赖。主要用于接收小程序发送的 HTML 内容并实时预览渲染效果。

## 🚀 核心特性

- **轻量简洁**: 无外部依赖，加载速度快
- **实时预览**: 接收小程序 HTML 内容并实时渲染
- **复制功能**: 支持复制标题和内容到剪贴板
- **微信集成**: 专为微信小程序 WebView 设计
- **响应式**: 支持各种设备尺寸
- **智能布局**: 粘性定位的标题和按钮组，始终可见
- **调试支持**: 集成 vConsole 移动端调试工具

## 📁 项目结构

```
miniWeb/
├── index.html              # 主入口文件（包含所有样式和脚本）
└── README.md               # 项目说明文档
```

## 🎯 功能特性

### 1. 文章预览

- **HTML 渲染**: 实时显示从小程序接收的 HTML 内容
- **内容解析**: 自动解析 HTML 标签并显示实际效果
- **安全过滤**: 基础的安全过滤，防止 XSS 攻击
- **文件下载**: 支持通过 URL 参数下载和显示文件内容

### 2. 复制功能

- **复制标题**: 从 URL 参数获取并复制文件名作为标题
- **复制内容**: 复制预览框内的 HTML 内容（包含格式和样式）
- **智能提示**: 根据内容状态显示相应的提示信息
- **降级支持**: 支持现代 Clipboard API 和传统 execCommand 方案

### 3. 微信小程序集成

- **URL 参数通信**: 通过 URL 查询参数接收文件下载链接和文件名
- **自动下载**: 自动检测并下载通过 URL 参数传递的文件内容
- **状态通知**: 通过 Toast 提示显示下载和操作状态
- **调试信息**: 通过 vConsole 查看详细的调试日志

### 4. 用户界面

- **粘性布局**: 标题和按钮组使用粘性定位，滚动时始终可见
- **渐变设计**: 蓝紫色渐变主题，现代化视觉体验
- **响应式设计**: 完美适配移动端和桌面端
- **交互反馈**: 按钮悬停效果和操作状态提示

## 🛠️ 使用方法

### 1. 直接使用

直接在浏览器中打开 `index.html` 文件即可查看效果。

### 2. 本地服务器

推荐使用本地服务器来避免 CORS 问题：

```bash
# 使用 Python 启动
python3 -m http.server 8000

# 或使用 Node.js
npx http-server -p 8000
```

然后在浏览器中访问：

- **主页面**: `http://localhost:8000/index.html`

### 3. 微信小程序集成

#### 通过 URL 参数传递文件信息：

```javascript
// 在微信小程序中构建 WebView URL
const webViewUrl = `https://your-domain.com/miniWeb/index.html?tempUrl=${encodeURIComponent(
  fileUrl
)}&fileName=${encodeURIComponent(fileName)}`;

// 使用 WebView 组件打开
<web-view src="{{webViewUrl}}"></web-view>;
```

#### URL 参数说明：

- `tempUrl`: 文件的临时下载链接
- `fileName`: 文件名（用于显示标题和复制功能）

## 🔗 通信机制

### 1. URL 参数通信

当前版本主要通过 URL 查询参数进行通信：

```
https://your-domain.com/miniWeb/index.html?tempUrl=https://example.com/file.html&fileName=示例文章.html
```

### 2. 文件下载流程

1. **参数检测**: 页面加载时自动检测 URL 参数
2. **文件下载**: 如果存在 `tempUrl` 参数，自动下载文件内容
3. **内容渲染**: 将下载的 HTML 内容渲染到预览区域
4. **状态更新**: 更新页面状态和用户提示

### 3. 复制功能

- **标题复制**: 从 `fileName` 参数获取文件名并复制
- **内容复制**: 复制预览区域内的完整 HTML 内容
- **格式保持**: 支持 HTML 格式和纯文本格式的复制

## 🎨 界面设计

### 页面布局

1. **顶部标题**: "文章预览-创作者工具"（粘性定位）
2. **复制按钮**: 两个横排按钮，支持复制标题和内容（粘性定位）
3. **预览区域**: 大容器显示 HTML 内容的渲染效果
4. **调试面板**: 右下角 vConsole 按钮（开发环境）

### 样式特点

- **渐变色彩**: 蓝紫色渐变主题 (`#667eea` → `#764ba2`)
- **卡片设计**: 圆角边框和阴影效果
- **粘性定位**: 标题和按钮组在滚动时始终可见
- **响应式**: 完美支持移动端和桌面端
- **交互反馈**: 按钮悬停和点击效果

## 🔧 技术实现

### 核心功能

- **HTML 解析**: 使用 `innerHTML` 渲染 HTML 内容
- **文件下载**: 基于 Fetch API 的文件下载功能
- **剪贴板操作**: 支持现代浏览器的 Clipboard API 和降级方案
- **URL 解析**: 使用 URLSearchParams 解析查询参数
- **状态管理**: 全局变量存储接收到的数据

### 布局技术

- **粘性定位**: 使用 `position: sticky` 实现始终可见的头部
- **Flexbox**: 灵活的按钮布局和居中对齐
- **CSS Grid**: 响应式网格布局
- **媒体查询**: 移动端和桌面端的适配

### 调试支持

- **vConsole 集成**: 移动端调试面板
- **配置开关**: 通过 `CONFIG.ENABLE_VCONSOLE` 控制调试功能
- **详细日志**: 下载过程、复制操作等关键操作的日志记录
- **错误处理**: 完善的异常处理和用户提示

## 📱 浏览器支持

- Chrome (推荐)
- Firefox
- Safari
- Edge
- 移动端浏览器
- 微信内置浏览器

## 🌟 最佳实践

1. **内容安全**: 对 HTML 内容进行安全过滤
2. **错误处理**: 完善的异常处理机制
3. **用户体验**: 清晰的状态提示和反馈
4. **性能优化**: 避免频繁的 DOM 操作
5. **调试友好**: 开发环境启用 vConsole，生产环境关闭

## 🔧 配置说明

### 开发环境配置

```javascript
const CONFIG = {
  ENABLE_VCONSOLE: true, // 启用调试面板
};
```

### 生产环境配置

```javascript
const CONFIG = {
  ENABLE_VCONSOLE: false, // 关闭调试功能
};
```

## 🚀 部署说明

1. **上传文件**: 将 `index.html` 上传到 Web 服务器
2. **配置域名**: 确保域名支持 HTTPS（微信小程序要求）
3. **测试功能**: 验证文件下载和复制功能
4. **性能优化**: 生产环境关闭调试功能

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进这个工具！

## 📄 许可证

MIT License - 可自由使用和修改

---

**开始使用**: 直接打开 `index.html` 文件，或者启动本地服务器来查看完整效果。

**微信小程序集成**: 通过 URL 参数传递文件下载链接和文件名，实现文件内容的自动下载和预览。

**核心功能**: 专注于文章预览和内容复制，为创作者提供简洁高效的工具，支持粘性布局和响应式设计。
